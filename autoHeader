Sub autoHeader()

' Developed in America by Tom Holmes tholmes@dtcc.com

    Dim endColumn
    Dim counter
    Dim test
    Dim firstSheet
    
    test = True
    firstSheet = ActiveSheet.Name
    
    
    Application.DisplayAlerts = False 'turns off dialog prompts
    Application.CutCopyMode = False 'clears clipboard
    ActiveSheet.Copy Before:=Worksheets(1) 'creates a copy of the original worksheet
    Sheets(firstSheet).Select
    
    
      While test = True
        Range("A1").Select
        If ActiveCell.Value <> "*Comment" Then
            Rows("1:1").Select
            Selection.Delete Shift:=xlUp
        ElseIf ActiveCell.Value <> Empty Then
            test = False
        End If
        'method to revert if no "*comment" is found
        If WorksheetFunction.CountA(ActiveSheet.UsedRange) = 0 And ActiveSheet.Shapes.count = 0 Then
            Worksheets(1).Select
            Range("A1").Select
            On Error Resume Next
            Set mylastcell = Cells(1, 1).SpecialCells(xlLastCell)
            mylastcelladd = Cells(mylastcell.Row, mylastcell.Column).Address
            myrange = "A1:" & mylastcelladd
            Range(myrange).Select
            Selection.Copy
            Sheets(firstSheet).Select
            ActiveSheet.Paste
            Range("A1").Select
            Worksheets(1).Delete
            Application.DisplayAlerts = True 'turns back on dialog prompts for normal usage
            MsgBox "Could not find the '*comment' box in column 1. Please verify this is the sheet where you want to insert a header.", vbInformation, "Warning!"
        Exit Sub
        End If
         
      Wend
               
     
         Range("A1").Select
         
         If ActiveCell.Value = "*Comment" Then
         Selection.End(xlToRight).Select
         endColumn = ActiveCell.Column
         Rows("1:1").Select
         Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
        
         Range("A1").Select
         ActiveCell.FormulaR1C1 = "*1"
         
         For i = 2 To endColumn
             ActiveCell.Offset(0, 1).Select
             ActiveCell.Value = i
         
         Next i
         
         Range("A1").Select
         End If
    
    Worksheets(1).Delete
    Application.DisplayAlerts = True 'turns back on dialog prompts for normal usage
  
End Sub

